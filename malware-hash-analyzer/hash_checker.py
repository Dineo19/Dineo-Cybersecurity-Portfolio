import hashlib
import os

def calculate_sha256(file_path):
    """Calculate SHA256 hash for a given file."""
    sha256_hash = hashlib.sha256()

    try:
        with open(file_path, "rb") as f:
            for byte_block in iter(lambda: f.read(4096), b""):
                sha256_hash.update(byte_block)
        return sha256_hash.hexdigest()

    except FileNotFoundError:
        print("Error: File not found.")
        return None


def check_malicious_hash(hash_value):
    """Checks if the hash matches a known malicious list."""
    malicious_hashes = {
        "e99a18c428cb38d5f260853678922e03abd8331a..." : "Example Malware A",
        "5d41402abc4b2a76b9719d911017c592" : "Example Malware B"
    }

    return malicious_hashes.get(hash_value, None)


def main():
    print("\n=== Malware Hash Analyzer ===")
    file_path = input("Enter file path to scan: ")

    print("\nCalculating SHA256 hash...")
    file_hash = calculate_sha256(file_path)

    if not file_hash:
        return

    print(f"\nSHA256 Hash:\n{file_hash}")

    print("\nChecking against known malware signatures...")
    result = check_malicious_hash(file_hash)

    if result:
        print(f"\n⚠ MALICIOUS FILE DETECTED: {result}")
    else:
        print("\n✔ File not found in malicious hash list.")

    print("\nAnalysis Complete.\n")


if __name__ == "__main__":
    main()
