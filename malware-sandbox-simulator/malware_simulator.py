import time
import os
import random
from datetime import datetime

LOG_FILE = "sandbox_logs.txt"

def log_event(event_type, details):
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    with open(LOG_FILE, "a") as f:
        f.write(f"[{timestamp}] {event_type}: {details}\n")
    print(f"üîç {event_type}: {details}")

def simulate_file_encryption():
    files = ["report.docx", "image.png", "data.csv", "notes.txt"]
    encrypted = random.sample(files, random.randint(1, len(files)))
    for file in encrypted:
        log_event("File Encryption", f"Encrypted ‚Üí {file}")
    return encrypted

def simulate_network_callback():
    ip = random.choice(["198.51.100.23", "203.0.113.5", "45.33.12.90"])
    log_event("C2 Traffic", f"Attempted connection to {ip}")

def simulate_persistence():
    method = random.choice([
        "Registry Run Key Added",
        "Startup Folder Persistence",
        "Scheduled Task Created"
    ])
    log_event("Persistence Mechanism", method)

def simulate_privilege_escalation():
    actions = [
        "Attempted token escalation",
        "Tried accessing SYSTEM files",
        "Modified admin privileges"
    ]
    log_event("Privilege Escalation", random.choice(actions))

def simulate_malware_behavior():
    print("\nüíÄ Malware Behavior Simulation Starting...\n")
    time.sleep(1)

    simulate_file_encryption()
    time.sleep(1)

    simulate_persistence()
    time.sleep(1)

    simulate_network_callback()
    time.sleep(1)

    simulate_privilege_escalation()
    time.sleep(1)

    log_event("Simulation Complete", "Malware behavior simulation finished.")

if __name__ == "__main__":
    if os.path.exists(LOG_FILE):
        os.remove(LOG_FILE)
    simulate_malware_behavior()
